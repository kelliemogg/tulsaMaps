<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Simple Map</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <link rel="stylesheet" type="text/css" href="css/styles.css" />
    <script src="js/index.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="//code.jquery.com/jquery-1.12.4.js"></script>
    <script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->

        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  </head>
  <body>
    <div class="blogs content"></div>
    <div class="ui-widget">
      <form method="GET" class="form-inline">
    <input type="text" name="search" maxlength="128" class="form-controls" placeholder="Search Box"/>
    <input type="submit" value="Search" class="btn btn-primary">
      </form>
    <ul id="places_output"></ul>
  </div>
</div>
  <script>
    $(document).ready(function () {
      $("#place").autocomplete({
            source: async function(request, response) {
                let data = await fetch(`http://localhost:5000/search?search=${request.term}`)
                    .then(results => results.json())
                    .then(results => results.map(result => {
                        return { label: result.name, value: result.name, id: result._id };
                    }));
                response(data);
            },
            minLength: 2,
            select: function(event, ui) {
              fetch('http://localhost:5000/get/${ui.item.id}')
                .then(result => result.json())
                .then(result => {
                  $("#places_output").empty();
                  result.places_output.forEach(place => {
                    $("#places_output").append(`<li>${place}</li>`);
                  })

                })
            }
                    });
        });
  </script>
    <div id="map"></div>

    <!-- Async script executes immediately and must be after any DOM elements used in callback. -->
    <script async
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB_8hfUgIKpvjwAX-OYIHGAW5v1BTFO-bs&callback=initAutocomplete&libraries=places&v=weekly"></script>
  </body>
</html>
